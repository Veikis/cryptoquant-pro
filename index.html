<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>CQ Ultra - Motor Quântico</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;900&family=JetBrains+Mono:wght@400;700&display=swap');
        
        :root {
            --bg: #000000;
            --card: #0a0a0a;
            --blue: #3b82f6;
            --red: #ef4444;
            --green: #10b981;
            --yellow: #eab308;
            --purple: #a855f7;
            --orange: #f97316;
        }
        
        * {
            font-family: 'Inter', sans-serif;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }
        
        body {
            background: var(--bg);
            color: #fff;
            min-height: 100vh;
            overflow-x: hidden;
            margin: 0;
            padding: 0;
        }
        
        .mono { font-family: 'JetBrains Mono', monospace; }
        
        /* Glassmorphism Header */
        .glass-header { 
            background: rgba(2, 2, 2, 0.95); 
            backdrop-filter: blur(15px); 
            -webkit-backdrop-filter: blur(15px);
            border-bottom: 1px solid rgba(255,255,255,0.08); 
        }
        
        /* Cards Estilizados */
        .card-pro { 
            background: var(--card); 
            border: 1px solid rgba(255,255,255,0.04); 
            border-radius: 24px; 
            padding: 24px; 
            margin-bottom: 20px; 
            box-shadow: 0 4px 20px rgba(0,0,0,0.5); 
        }
        
        /* Barra de Fases */
        .phase-indicator { 
            background: #161618; 
            height: 45px; 
            border-radius: 14px; 
            display: flex; 
            align-items: center; 
            padding: 4px; 
            border: 1px solid rgba(255,255,255,0.05); 
            gap: 4px; 
        }
        .phase-step { 
            flex: 1; 
            text-align: center; 
            font-size: 8px; 
            font-weight: 900; 
            text-transform: uppercase; 
            color: #444; 
            display: flex; 
            align-items: center; 
            justify-content: center; 
            height: 100%; 
            border-radius: 10px; 
            transition: 0.5s; 
        }
        .phase-active { 
            background: var(--red); 
            color: white; 
            box-shadow: 0 0 15px rgba(239, 68, 68, 0.4); 
        }
        
        /* Tabs */
        .tab-btn { 
            font-size: 10px; 
            font-weight: 900; 
            text-transform: uppercase; 
            letter-spacing: 0.1em; 
            color: #555; 
            padding: 10px 4px; 
            border-bottom: 2px solid transparent; 
            transition: 0.3s; 
            cursor: pointer;
            background: none;
            border-top: none;
            border-left: none;
            border-right: none;
            white-space: nowrap;
        }
        .tab-btn.active { 
            color: var(--blue); 
            border-bottom-color: var(--blue); 
        }
        
        .tab-content {
            display: none;
        }
        .tab-content.active {
            display: block;
        }
        
        .gauge-bg { 
            background: #1a1a1c; 
            height: 8px; 
            border-radius: 10px; 
            overflow: hidden; 
            margin-top: 8px; 
        }
        .gauge-fill { 
            height: 100%; 
            border-radius: 10px; 
            transition: width 1.5s cubic-bezier(0.175, 0.885, 0.32, 1.275); 
        }
        
        /* Status Indicators */
        .status-badge {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            padding: 4px 10px;
            border-radius: 20px;
            font-size: 9px;
            font-weight: 900;
            text-transform: uppercase;
            margin-bottom: 8px;
        }
        .status-extreme-fear { background: rgba(239, 68, 68, 0.15); color: #ef4444; border: 1px solid rgba(239, 68, 68, 0.3); }
        .status-fear { background: rgba(234, 179, 8, 0.15); color: #eab308; border: 1px solid rgba(234, 179, 8, 0.3); }
        .status-neutral { background: rgba(59, 130, 246, 0.15); color: #3b82f6; border: 1px solid rgba(59, 130, 246, 0.3); }
        .status-greed { background: rgba(16, 185, 129, 0.15); color: #10b981; border: 1px solid rgba(16, 185, 129, 0.3); }
        
        .indicator-value {
            font-family: 'JetBrains Mono', monospace;
            font-size: 18px;
            font-weight: 700;
            margin-bottom: 4px;
        }
        
        .tech-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
        }
        @media (max-width: 640px) {
            .tech-grid { grid-template-columns: 1fr; }
        }
        
        /* Upload areas */
        .upload-area {
            position: relative;
            cursor: pointer;
            transition: all 0.3s;
        }
        .upload-area:hover {
            border-color: rgba(59, 130, 246, 0.5);
            background: rgba(59, 130, 246, 0.05);
        }
        .upload-area input[type="file"] {
            position: absolute;
            inset: 0;
            opacity: 0;
            cursor: pointer;
            width: 100%;
            height: 100%;
        }
        
        /* Animação de scan */
        @keyframes scan {
            0% { transform: translateY(-100%); opacity: 0; }
            50% { opacity: 1; }
            100% { transform: translateY(100%); opacity: 0; }
        }
        .scan-line {
            position: absolute;
            left: 0;
            right: 0;
            height: 2px;
            background: linear-gradient(90deg, transparent, var(--blue), transparent);
            animation: scan 2s linear infinite;
            pointer-events: none;
        }
        
        /* Fib levels */
        .fib-level {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 8px 12px;
            background: rgba(255,255,255,0.02);
            border-radius: 8px;
            margin-bottom: 6px;
            border-left: 3px solid transparent;
        }
        .fib-active {
            background: rgba(59, 130, 246, 0.1);
            border-left-color: var(--blue);
        }
        
        ::-webkit-scrollbar { width: 0px; background: transparent; }
        
        .hidden { display: none !important; }
    </style>
</head>
<body>

<header class="fixed top-0 left-0 right-0 z-50 glass-header px-6 py-5 flex justify-between items-center">
    <div>
        <h1 class="text-white font-black text-xl italic tracking-tighter uppercase">CQ <span class="text-blue-500">Ultra</span></h1>
        <div class="flex items-center space-x-2">
            <div class="w-2 h-2 bg-green-500 rounded-full animate-pulse shadow-[0_0_8px_#10b981]"></div>
            <span class="text-[8px] mono text-gray-500 uppercase font-bold">Motor Quântico Ativo</span>
        </div>
    </div>
    <div class="text-right">
        <div id="price" class="text-2xl font-black mono text-white leading-none tracking-tighter">$0.00</div>
        <div id="change" class="text-[9px] font-bold mt-1 text-gray-500 uppercase tracking-widest">Sincronizando...</div>
    </div>
</header>

<main class="pt-28 px-4 max-w-xl mx-auto pb-20">

    <div class="mb-8">
        <div class="flex justify-between items-end mb-3">
            <h3 class="text-[10px] font-black text-gray-500 uppercase tracking-widest">Estado do Ciclo</h3>
            <span class="text-[10px] font-black text-red-500 uppercase">Fase: Capitulação</span>
        </div>
        <div class="phase-indicator">
            <div class="phase-step">Acumulação</div>
            <div class="phase-step">Alta</div>
            <div class="phase-step">Euforia</div>
            <div class="phase-step">Queda</div>
            <div class="phase-step phase-active">Capitulação</div>
        </div>
        <p class="text-[9px] text-gray-600 mt-3 italic text-center uppercase font-bold tracking-tight">Oportunidade de fundo geracional detectada nas métricas on-chain.</p>
    </div>

    <nav class="flex space-x-6 mb-8 px-2 overflow-x-auto no-scrollbar border-b border-white/5">
        <button class="tab-btn active" data-tab="terminal">Terminal</button>
        <button class="tab-btn" data-tab="detalhes">On-Chain</button>
        <button class="tab-btn" data-tab="tecnico">Técnico</button>
        <button class="tab-btn" data-tab="miner">Mineradores</button>
        <button class="tab-btn" data-tab="hist">Padrões</button>
    </nav>

    <!-- TAB TERMINAL -->
    <section id="tab-terminal" class="tab-content active">
        <div class="card-pro border-blue-500/20">
            <div class="flex justify-between items-center mb-6">
                <h3 class="text-[11px] font-black text-blue-400 uppercase">Entrada de Dados 21:00h</h3>
                <div id="sync-status" class="text-[8px] mono px-2 py-1 bg-gray-800 rounded text-gray-400 uppercase">Vazio</div>
            </div>
            
            <div class="grid grid-cols-2 gap-4 mb-4">
                <div class="upload-area h-36 border-2 border-dashed border-gray-800 rounded-[30px] flex flex-col items-center justify-center bg-black/40 relative overflow-hidden group">
                    <input type="file" id="f1" accept="image/*" onchange="handleFile(this, 'p1', 'l1', 'chart')">
                    <img id="p1" class="hidden absolute inset-0 w-full h-full object-cover">
                    <span id="l1" class="text-[10px] font-black text-gray-600 group-hover:text-blue-500 transition-colors uppercase pointer-events-none">Gráficos</span>
                </div>
                <div class="upload-area h-36 border-2 border-dashed border-gray-800 rounded-[30px] flex flex-col items-center justify-center bg-black/40 relative overflow-hidden group">
                    <input type="file" id="f2" accept="image/*" onchange="handleFile(this, 'p2', 'l2', 'onchain')">
                    <img id="p2" class="hidden absolute inset-0 w-full h-full object-cover">
                    <div id="scan-effect" class="scan-line hidden"></div>
                    <span id="l2" class="text-[10px] font-black text-gray-600 group-hover:text-blue-500 transition-colors uppercase pointer-events-none">On-Chain</span>
                </div>
            </div>
            
            <button onclick="analisar()" class="w-full bg-blue-600 hover:bg-blue-700 py-5 rounded-2xl text-[11px] font-black uppercase tracking-widest active:scale-95 transition-all">Sincronizar e Comparar</button>
        </div>

        <div id="res-box" class="hidden card-pro border-white/5 bg-white/[0.02]">
            <div id="res-header" class="mb-4"></div>
            <div id="res-body" class="text-xs leading-relaxed text-gray-300 space-y-4"></div>
        </div>
    </section>

    <!-- TAB ON-CHAIN -->
    <section id="tab-detalhes" class="tab-content">
        <div class="card-pro space-y-8">
            <h3 class="text-[11px] font-black text-blue-400 uppercase tracking-widest border-b border-white/5 pb-2">Enciclopédia On-Chain</h3>
            
            <div id="indicadores-dinamicos" class="space-y-6 hidden">
                <div class="bg-white/[0.02] rounded-xl p-4 border border-white/5">
                    <div class="flex justify-between items-start mb-2">
                        <h4 class="text-xs font-black text-white uppercase">SOPR</h4>
                        <span id="sopr-status" class="status-badge status-extreme-fear">● Capitulação</span>
                    </div>
                    <div id="sopr-valor" class="indicator-value text-red-500">0.94</div>
                    <p id="sopr-desc" class="text-[11px] text-gray-400 leading-relaxed">Mede lucro/prejuízo na venda de BTC.</p>
                    <div class="mt-3 flex items-center gap-2">
                        <div class="flex-1 h-1 bg-gray-800 rounded-full overflow-hidden">
                            <div id="sopr-bar" class="h-full bg-red-500 rounded-full" style="width: 30%"></div>
                        </div>
                    </div>
                </div>

                <div class="bg-white/[0.02] rounded-xl p-4 border border-white/5">
                    <div class="flex justify-between items-start mb-2">
                        <h4 class="text-xs font-black text-white uppercase">Netflow</h4>
                        <span id="netflow-status" class="status-badge status-greed">● Retirada</span>
                    </div>
                    <div id="netflow-valor" class="indicator-value text-green-500">-2,450 BTC</div>
                    <p id="netflow-desc" class="text-[11px] text-gray-400 leading-relaxed">Fluxo de entrada/saída das exchanges.</p>
                </div>

                <div class="bg-white/[0.02] rounded-xl p-4 border border-white/5">
                    <div class="flex justify-between items-start mb-2">
                        <h4 class="text-xs font-black text-white uppercase">Funding Rate</h4>
                        <span id="funding-status" class="status-badge status-fear">● Negativo</span>
                    </div>
                    <div id="funding-valor" class="indicator-value text-yellow-500">-0.015%</div>
                    <p id="funding-desc" class="text-[11px] text-gray-400 leading-relaxed">Taxa entre traders de futuros.</p>
                </div>
            </div>

            <div id="indicadores-vazio" class="text-center py-8">
                <div class="w-16 h-16 mx-auto mb-4 rounded-full bg-gray-900 flex items-center justify-center">
                    <svg class="w-8 h-8 text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"></path>
                    </svg>
                </div>
                <p class="text-[11px] text-gray-500">Nenhum dado on-chain detectado.</p>
                <p class="text-[10px] text-gray-600 mt-1">Faça upload na aba Terminal.</p>
            </div>
        </div>
    </section>

    <!-- TAB TÉCNICO -->
    <section id="tab-tecnico" class="tab-content">
        <div class="card-pro mb-4">
            <h3 class="text-[11px] font-black text-purple-400 uppercase tracking-widest border-b border-white/5 pb-2 mb-4">Momentum</h3>
            
            <div class="tech-grid">
                <div class="bg-white/[0.02] rounded-xl p-4 border border-white/5">
                    <h4 class="text-[10px] font-black text-gray-400 uppercase mb-2">RSI (14)</h4>
                    <div class="flex items-end gap-2 mb-2">
                        <span id="rsi-valor" class="text-2xl font-black mono text-yellow-500">32.4</span>
                    </div>
                    <div class="relative h-2 bg-gray-800 rounded-full overflow-hidden mb-2">
                        <div id="rsi-bar" class="absolute left-0 h-full bg-yellow-500 rounded-full transition-all" style="width: 32%"></div>
                    </div>
                    <p id="rsi-desc" class="text-[10px] text-gray-500">Sobrevendido</p>
                </div>

                <div class="bg-white/[0.02] rounded-xl p-4 border border-white/5">
                    <h4 class="text-[10px] font-black text-gray-400 uppercase mb-2">MACD</h4>
                    <div class="space-y-1">
                        <div class="flex justify-between text-[10px]">
                            <span class="text-gray-500">Hist:</span>
                            <span id="macd-hist" class="mono text-green-500">+46.8</span>
                        </div>
                    </div>
                    <p id="macd-desc" class="text-[10px] text-gray-500 mt-2">Convergência bullish</p>
                </div>
            </div>
        </div>

        <div class="card-pro mb-4">
            <h3 class="text-[11px] font-black text-green-400 uppercase tracking-widest border-b border-white/5 pb-2 mb-4">Tendência</h3>
            
            <div class="space-y-3 mb-4">
                <div class="flex items-center justify-between p-3 bg-white/[0.02] rounded-lg">
                    <div class="flex items-center gap-3">
                        <div class="w-2 h-8 bg-yellow-500 rounded-full"></div>
                        <div>
                            <div class="text-[10px] text-gray-500 uppercase font-bold">MA 20</div>
                            <div class="text-sm font-black mono text-white">$71,240</div>
                        </div>
                    </div>
                    <div class="text-[9px] font-bold text-red-500 uppercase">▼ Abaixo</div>
                </div>
                
                <div class="flex items-center justify-between p-3 bg-white/[0.02] rounded-lg">
                    <div class="flex items-center gap-3">
                        <div class="w-2 h-8 bg-blue-500 rounded-full"></div>
                        <div>
                            <div class="text-[10px] text-gray-500 uppercase font-bold">MA 50</div>
                            <div class="text-sm font-black mono text-white">$68,450</div>
                        </div>
                    </div>
                    <div class="text-[9px] font-bold text-green-500 uppercase">▲ Acima</div>
                </div>
            </div>
        </div>

        <div class="card-pro">
            <h3 class="text-[11px] font-black text-blue-400 uppercase tracking-widest border-b border-white/5 pb-2 mb-4">Níveis</h3>
            
            <div class="grid grid-cols-2 gap-3">
                <div class="bg-red-500/5 border border-red-500/20 rounded-lg p-3">
                    <h4 class="text-[9px] font-black text-red-500 uppercase mb-2">Resistências</h4>
                    <div class="space-y-1">
                        <div class="flex justify-between">
                            <span class="text-[10px] text-gray-400">R1</span>
                            <span class="text-[11px] font-bold mono text-gray-300">$70,500</span>
                        </div>
                        <div class="flex justify-between border-t border-white/10 pt-1">
                            <span class="text-[10px] text-red-400 font-bold">Key</span>
                            <span class="text-[11px] font-black mono text-white">$73,800</span>
                        </div>
                    </div>
                </div>
                
                <div class="bg-green-500/5 border border-green-500/20 rounded-lg p-3">
                    <h4 class="text-[9px] font-black text-green-500 uppercase mb-2">Suportes</h4>
                    <div class="space-y-1">
                        <div class="flex justify-between">
                            <span class="text-[10px] text-gray-400">S1</span>
                            <span class="text-[11px] font-bold mono text-gray-300">$68,900</span>
                        </div>
                        <div class="flex justify-between border-t border-white/10 pt-1">
                            <span class="text-[10px] text-green-400 font-bold">Key</span>
                            <span class="text-[11px] font-black mono text-white">$65,500</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- TAB MINERADORES -->
    <section id="tab-miner" class="tab-content">
        <div class="card-pro space-y-6">
            <h3 class="text-[11px] font-black text-yellow-500 uppercase tracking-widest">Saúde dos Mineradores</h3>
            <div>
                <div class="flex justify-between items-end mb-2">
                    <span class="text-xs font-bold text-gray-400 uppercase italic">Puell Multiple</span>
                    <span class="text-lg font-black mono text-yellow-500">0.48</span>
                </div>
                <div class="gauge-bg"><div class="gauge-fill bg-yellow-500" style="width: 48%"></div></div>
                <p class="text-[10px] text-gray-500 mt-3 uppercase font-medium">Zona de Estresse Máximo</p>
            </div>
        </div>
    </section>

    <!-- TAB HISTÓRICO -->
    <section id="tab-hist" class="tab-content">
        <div class="card-pro space-y-6">
            <h3 class="text-[11px] font-black text-gray-400 uppercase tracking-widest">Memória de Ciclos</h3>
            <div class="border-l-2 border-blue-500 pl-4">
                <h4 class="text-xs font-black text-white uppercase">Analogia 2018</h4>
                <p class="text-[11px] text-gray-500 mt-1 italic">Cenário idêntico ao fim de 2018. Volume secando.</p>
            </div>
            <div class="border-l-2 border-green-500 pl-4">
                <h4 class="text-xs font-black text-white uppercase">Tendência 2020</h4>
                <p class="text-[11px] text-gray-500 mt-1 italic">Recuperação em V-shape depende do netflow.</p>
            </div>
        </div>
    </section>

</main>

<script>
    // --- VARIÁVEIS GLOBAIS ---
    let hashes = { chart: null, onchain: null };
    let wsConnection = null;
    let lastPrice = 0;

    // --- NAVEGAÇÃO DAS ABAS ---
    document.querySelectorAll('.tab-btn').forEach(btn => {
        btn.addEventListener('click', function(e) {
            e.preventDefault();
            const tabId = this.getAttribute('data-tab');
            
            // Remove active de todos
            document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
            
            // Adiciona active no clicado
            this.classList.add('active');
            document.getElementById('tab-' + tabId).classList.add('active');
        });
    });

    // --- UPLOAD DE ARQUIVOS ---
    function handleFile(input, imgId, labelId, type) {
        if (input.files && input.files[0]) {
            const file = input.files[0];
            hashes[type] = `${file.name}-${file.size}-${file.lastModified}`;
            
            const reader = new FileReader();
            reader.onload = function(e) {
                const img = document.getElementById(imgId);
                const label = document.getElementById(labelId);
                
                img.src = e.target.result;
                img.classList.remove('hidden');
                label.classList.add('hidden');
                
                // Efeito scan para onchain
                if (type === 'onchain') {
                    const scan = document.getElementById('scan-effect');
                    scan.classList.remove('hidden');
                    setTimeout(() => scan.classList.add('hidden'), 2000);
                    
                    // Simula extração
                    setTimeout(() => {
                        mostrarOnChain();
                    }, 800);
                }
                
                // Atualiza status
                const status = document.getElementById('sync-status');
                status.innerText = type === 'onchain' ? 'On-Chain OK' : 'Gráfico OK';
                status.classList.remove('bg-gray-800');
                status.classList.add(type === 'onchain' ? 'bg-green-900' : 'bg-purple-900');
                status.style.color = type === 'onchain' ? '#10b981' : '#a855f7';
            };
            reader.readAsDataURL(file);
        }
    }

    // --- MOSTRAR DADOS ON-CHAIN ---
    function mostrarOnChain() {
        document.getElementById('indicadores-vazio').classList.add('hidden');
        document.getElementById('indicadores-dinamicos').classList.remove('hidden');
    }

    // --- ANÁLISE ---
    function analisar() {
        const box = document.getElementById('res-box');
        const header = document.getElementById('res-header');
        const body = document.getElementById('res-body');
        
        box.classList.remove('hidden');
        
        const mem = JSON.parse(localStorage.getItem('cq_data') || '{"chart": "", "onchain": ""}');
        
        if (hashes.chart && hashes.onchain && 
            hashes.chart === mem.chart && hashes.onchain === mem.onchain) {
            header.innerHTML = '<span class="text-gray-500 font-black text-[9px] uppercase">● Dados Idênticos</span>';
            body.innerHTML = '<p class="text-gray-500">Nenhuma variação detectada desde a última análise.</p>';
        } else {
            header.innerHTML = '<span class="text-green-500 font-black text-[9px] uppercase">● Nova Análise</span>';
            body.innerHTML = `
                <p class="text-gray-300"><b class="text-blue-400">SOPR 0.94:</b> Capitulação confirmada. Investidores vendendo no prejuízo.</p>
                <p class="text-gray-300"><b class="text-green-400">Netflow -2,450 BTC:</b> Retirada massiva das exchanges. Pressão vendedora esgotada.</p>
                <p class="text-gray-300"><b class="text-yellow-400">RSI 32:</b> Sobrevendido técnico. Confluência perfeita com on-chain.</p>
            `;
            
            localStorage.setItem('cq_data', JSON.stringify(hashes));
        }
        
        window.scrollTo({ top: document.body.scrollHeight, behavior: 'smooth' });
    }

    // --- PREÇO EM TEMPO REAL ---
    function conectarPreco() {
        try {
            wsConnection = new WebSocket('wss://stream.binance.com:9443/ws/btcusdt@ticker');
            
            wsConnection.onopen = function() {
                console.log('WebSocket conectado');
                document.getElementById('change').innerText = 'CONECTADO';
                document.getElementById('change').style.color = '#10b981';
            };
            
            wsConnection.onmessage = function(event) {
                const data = JSON.parse(event.data);
                const price = parseFloat(data.c);
                const change = parseFloat(data.P);
                
                // Atualiza preço
                document.getElementById('price').innerText = '$' + price.toLocaleString('en-US', {
                    minimumFractionDigits: 2,
                    maximumFractionDigits: 2
                });
                
                // Atualiza variação
                const changeText = (change >= 0 ? '+' : '') + change.toFixed(2) + '% AO VIVO';
                document.getElementById('change').innerText = changeText;
                document.getElementById('change').style.color = change >= 0 ? '#10b981' : '#ef4444';
                
                // Cor do preço baseado na direção
                if (price > lastPrice) {
                    document.getElementById('price').style.color = '#10b981';
                } else if (price < lastPrice) {
                    document.getElementById('price').style.color = '#ef4444';
                } else {
                    document.getElementById('price').style.color = '#ffffff';
                }
                
                lastPrice = price;
            };
            
            wsConnection.onerror = function(error) {
                console.error('WebSocket erro:', error);
                document.getElementById('change').innerText = 'ERRO DE CONEXÃO';
                document.getElementById('change').style.color = '#ef4444';
            };
            
            wsConnection.onclose = function() {
                console.log('WebSocket fechado, reconectando...');
                document.getElementById('change').innerText = 'RECONECTANDO...';
                document.getElementById('change').style.color = '#eab308';
                setTimeout(conectarPreco, 3000);
            };
            
        } catch (e) {
            console.error('Erro ao conectar:', e);
            document.getElementById('change').innerText = 'ERRO';
            setTimeout(conectarPreco, 5000);
        }
    }

    // --- INICIALIZAÇÃO ---
    document.addEventListener('DOMContentLoaded', function() {
        conectarPreco();
        
        // Preço inicial simulado enquanto conecta
        document.getElementById('price').innerText = '$69,828.10';
        lastPrice = 69828.10;
    });
</script>

</body>
</html>
