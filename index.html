<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>CryptoQuant Pro</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: -apple-system, sans-serif; }
        body { background: #000; color: #fff; padding-bottom: 80px; }
        .ticker { font-family: monospace; }
        .header { background: rgba(20, 20, 20, 0.95); border-bottom: 1px solid #333; padding: 15px; position: fixed; top: 0; left: 0; right: 0; z-index: 100; }
        .live-dot { width: 8px; height: 8px; background: #10b981; border-radius: 50%; display: inline-block; animation: pulse 1s infinite; margin-right: 8px; }
        @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.5; } }
        .price-up { color: #10b981; }
        .price-down { color: #ef4444; }
        .main-content { padding-top: 130px; }
        .card { background: #1c1c1e; border-radius: 12px; margin: 10px 15px; padding: 15px; border: 1px solid #333; }
        .metric { display: flex; justify-content: space-between; padding: 8px 0; border-bottom: 1px solid #333; }
        .btn { background: #3b82f6; color: white; border: none; padding: 15px; border-radius: 10px; font-weight: bold; width: 100%; margin-top: 10px; }
        .status { position: fixed; top: 10px; right: 10px; padding: 4px 8px; border-radius: 4px; font-size: 10px; z-index: 101; }
        .status-connected { background: #10b981; color: #000; }
        .status-connecting { background: #f59e0b; color: #000; }
        .bottom-nav { position: fixed; bottom: 0; left: 0; right: 0; background: #141414; border-top: 1px solid #333; padding: 15px; display: flex; gap: 10px; }
        input { background: #2c2c2e; border: 1px solid #444; color: white; padding: 10px; border-radius: 8px; width: 100%; }
    </style>
</head>
<body>
    <div id="status" class="status status-connecting">Conectando...</div>

    <div class="header">
        <div style="display: flex; align-items: center; margin-bottom: 5px;">
            <span class="live-dot"></span>
            <span style="font-size: 12px; color: #888;">BTC/USDT Perpetual</span>
        </div>
        <div style="display: flex; justify-content: space-between;">
            <div>
                <div id="main-price" class="ticker" style="font-size: 28px; font-weight: bold;">0.00</div>
                <div id="price-change" style="font-size: 14px;"></div>
            </div>
            <div style="text-align: right; font-size: 11px; color: #888;">
                <div>High: <span id="high-24h" class="ticker">0.00</span></div>
                <div>Low: <span id="low-24h" class="ticker">0.00</span></div>
            </div>
        </div>
    </div>

    <div class="main-content">
        <div class="card">
            <h3 style="font-size: 12px; color: #888; margin-bottom: 10px;">MÃ‰TRICAS AO VIVO</h3>
            <div class="metric"><span>RSI (14)</span><span id="rsi" class="ticker">0.00</span></div>
            <div class="metric"><span>Open Interest</span><span id="oi" class="ticker">0.00</span></div>
            <div class="metric"><span>Liquidations</span><span id="liq" class="ticker">0.00</span></div>
        </div>

        <div class="card">
            <h3 style="font-size: 12px; color: #888; margin-bottom: 10px;">ORDER BOOK</h3>
            <div id="asks"></div>
            <div id="spread" style="text-align: center; padding: 10px; font-weight: bold; border-top: 1px solid #333; border-bottom: 1px solid #333;">0.00</div>
            <div id="bids"></div>
        </div>

        <div class="card">
            <h3 style="font-size: 12px; color: #888; margin-bottom: 10px;">TRADES RECENTES</h3>
            <div id="trades"></div>
        </div>
    </div>

    <div class="bottom-nav">
        <input type="number" id="amount" placeholder="0.00 BTC">
        <button class="btn" style="background: #10b981;">BUY</button>
        <button class="btn" style="background: #ef4444;">SELL</button>
    </div>

    <script>
        let ws = null;
        
        function connect() {
            const status = document.getElementById('status');
            const WS_URL = window.location.origin.replace(/^http/, 'ws');
            
            ws = new WebSocket(WS_URL);
            
            ws.onopen = () => {
                status.textContent = 'LIVE';
                status.className = 'status status-connected';
            };
            
            ws.onmessage = (event) => {
                const data = JSON.parse(event.data);
                updateUI(data);
            };
            
            ws.onclose = () => {
                status.textContent = 'Reconectando...';
                status.className = 'status status-connecting';
                setTimeout(connect, 2000);
            };
        }

        function updateUI(data) {
            document.getElementById('main-price').textContent = data.price.toFixed(2);
            document.getElementById('high-24h').textContent = data.high24h.toFixed(2);
            document.getElementById('low-24h').textContent = data.low24h.toFixed(2);
            document.getElementById('rsi').textContent = data.rsi.toFixed(2);
            document.getElementById('oi').textContent = data.openInterest.toFixed(2);
            document.getElementById('liq').textContent = '$' + data.liquidations.toFixed(2) + 'M';
            document.getElementById('spread').textContent = data.price.toFixed(2);
            
            document.getElementById('price-change').innerHTML = 
                `<span class="${data.change24h >= 0 ? 'price-up' : 'price-down'}">${data.change24h}%</span>`;

            // Atualiza Order Book
            let asksHtml = '';
            data.orderBook.asks.forEach(a => {
                asksHtml += `<div style="display:flex; justify-content:space-between; font-size:12px">
                    <span class="price-down">${a[0]}</span><span>${a[1]}</span></div>`;
            });
            document.getElementById('asks').innerHTML = asksHtml;

            let bidsHtml = '';
            data.orderBook.bids.forEach(b => {
                bidsHtml += `<div style="display:flex; justify-content:space-between; font-size:12px">
                    <span class="price-up">${b[0]}</span><span>${b[1]}</span></div>`;
            });
            document.getElementById('bids').innerHTML = bidsHtml;

            // Atualiza Trades
            let tradesHtml = '';
            data.trades.slice(0, 5).forEach(t => {
                tradesHtml += `<div style="display:flex; justify-content:space-between; font-size:11px">
                    <span class="${t.isBuyer ? 'price-up' : 'price-down'}">${t.price.toFixed(2)}</span>
                    <span style="color:#888">${t.time}</span></div>`;
            });
            document.getElementById('trades').innerHTML = tradesHtml;
        }

        connect();
    </script>
</body>
</html>
